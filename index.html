<html>
<title>jsChemistry</title>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<script src="point2d.js"></script>
<script src="collision.js"></script>
<script src="reaction.js"></script>
<script src="drawing.js"></script>
<script src="math.js"></script>
</head>
<body>

<body onload="animate();"><body> <!-- avoid starting twice -->

<canvas id="myCanvas"></canvas>
<p>
<button type="button" onclick="pause = !pause;">Pause/Play</button>
<button type="button" onclick="speed = fastSpeed;">Fast</button>
<button type="button" onclick="speed = mediumSpeed;">Medium</button>
<button type="button" onclick="speed = slowSpeed;">Slow</button>
<p>
<button type="button" onclick="show_unbonded_atoms = !show_unbonded_atoms;">Show/hide the bath</button>
<button type="button" onclick="withTemperatureGradient = !withTemperatureGradient;">Temperature gradient on/off</button>
<p> 
<script>
    
var slowSpeed = 1;
var mediumSpeed = 5;
var fastSpeed = 100;
    
var withReversibility = true;
var withTemperatureGradient = true;
var withCosmicRays = false;
var cosmicRayBondingProbability = 0.00001;
var cosmicRayUnbondingProbability = 0.00001;
var speed = slowSpeed;
var logReactions = false;
var scale = 10.0;
var show_unbonded_atoms = true;
var xSize = 100;
var ySize = 60;

var chararray = [ 'a', 'b', 'c', 'd', 'e', 'f' ];
var canvas  = document.getElementById( 'myCanvas' );
var context = canvas.getContext( '2d' );

canvas.width = (xSize+2)*scale;
canvas.height = (ySize+2)*scale;

var atoms = new Array();
setupInteractionMatrix();

for( var i = 0; i < 500; ++i )
{
    var charidx = Math.floor(Math.random()*chararray.length);
    atoms[i] = new Atom();
    atoms[i].pos = new Point2D( Math.random()*xSize, Math.random()*ySize );
    atoms[i].vel = new Point2D( Math.random()*2.0-1.0, Math.random()*2.0-1.0 );
    atoms[i].label = chararray[charidx] + "0";
}

addMolecule(["e5","a1","b2","c3","d4","fC"],10,20,atoms); // for ladder-free rep the atoms pass their type as a number (a=1,etc)
addMolecule(["e5","b2","d4","b2","d4","fC"],10,30,atoms); // for ladder-free rep the atoms pass their type as a number (a=1,etc)
//addMolecule(["e5","fC"],10,30,atoms); // simplest replicator in this ruleset

function onMouseMove( evt )
{
}

var pause = false;

window.requestAnimFrame = (function(callback)
{
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
        function(callback) {
            window.setTimeout(callback, 1000 / 30);
        };
})();

function update()
{
    if (!pause)
    for( var i = 0; i < speed; ++i )
    {
        iterateAll( atoms, 0.2 );
    }
}

function animate()
{
    update();

    // draw the background
    context.fillStyle = "rgb(200,200,200)";
    context.beginPath();
    context.fillRect( 0, 0, canvas.width, canvas.height );
    context.closePath();

    drawAtoms( atoms, context );

    // request new frame
    requestAnimFrame( animate );
}

</script> 
</body>
</html>
