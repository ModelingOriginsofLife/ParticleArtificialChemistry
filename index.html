<html>
<title>jsChemistry</title>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<script src="point2d.js"></script>
<script src="collision.js"></script>
<script src="reaction.js"></script>
<script src="drawing.js"></script>
<script src="math.js"></script>
</head>
<body>

<body onload="animate();"><body> <!-- avoid starting twice -->

<canvas id="myCanvas"></canvas>
<p>
<button type="button" onclick="pause = !pause;">Pause/Play</button>
<button type="button" onclick="speed=100;">Fast</button>
<button type="button" onclick="speed=5;">Medium</button>
<button type="button" onclick="speed=1;">Slow</button>
<p>
<button type="button" onclick="show_unbonded_atoms = !show_unbonded_atoms;">Show the bath</button>
<button type="button" onclick="withTemperatureGradient = !withTemperatureGradient;">Toggle temperature gradient</button>
<p> 
<script>
    
var withReversibility = true;
var withTemperatureGradient = true;
var speed = 5;
var logReactions = false;
var scale = 10.0;
var show_unbonded_atoms = false;

var chararray = [ 'a', 'b', 'c', 'd', 'e', 'f' ];
var canvas  = document.getElementById( 'myCanvas' );
var context = canvas.getContext( '2d' );

xSize = ySize = 50;

canvas.width = (xSize+2)*scale;
canvas.height = (ySize+2)*scale;

var atoms = new Array();
setupInteractionMatrix();

for( var i = 0; i < 200; ++i )
{
    var charidx = Math.floor(Math.random()*chararray.length);
    atoms[i] = new Atom();
    atoms[i].pos = new Point2D( Math.random()*xSize, Math.random()*ySize );
    atoms[i].vel = new Point2D( Math.random()*2.0-1.0, Math.random()*2.0-1.0 );
    atoms[i].label = chararray[charidx] + "0";
}

//addMolecule(["a1","b1"],10,20,atoms);
//addMolecule(["e8","b1",/*"a1","d1","d1","b1","c1",*/"f1"],10,20,atoms);
addMolecule(["e5","a1","b2","c3","d4","fC"],10,20,atoms); // for ladder-free rep the atoms pass their type as a number (a=1,etc)

function onMouseMove( evt )
{
}

var pause = false;

window.requestAnimFrame = (function(callback)
{
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
        function(callback) {
            window.setTimeout(callback, 1000 / 30);
        };
})();

function update()
{
    if (!pause)
    for( var i = 0; i < speed; ++i )
    {
        iterateAll( atoms, 0.2 );
    }
}

function animate()
{
    update();

    // draw the background
    context.fillStyle = "rgb(200,200,200)";
    context.beginPath();
    context.fillRect( 0, 0, canvas.width, canvas.height );
    context.closePath();

    drawAtoms( atoms, context );

    // request new frame
    requestAnimFrame( animate );
}

</script> 
</body>
</html>
